<body>
<style>script{ display:block; }</style>
<div id="target" style="position:absolute; right:1em; top:1em;"></div>

<pre>
<script src="../js/notanotherpubsub.js"></script>
<script>
subscribe("jquery ready", function(){
    console.log("Run 2")
    $("#target").append("Subscribed to: jQuery ready 1<br/>")
});

subscribe("jquery ready", function(){
    console.log("Run 3")
     $("#target").append("Subscribed to: jQuery ready 2<br/>")
     publish("with arguments",["hello"," ","world"])
     publish("with this",null,[1,2,3])
});

subscribe("with arguments", function(a,b,c){
    console.log("with arguments")
     $("#target").append("Subscribed to: with arguments "+a+b+c+"<br/>")
});

subscribe("with this", function(){
    console.log("with this")
     $("#target").append("Subscribed to: with this<br/>")

     for( var x=0; x< this.length; x++ ){
        $("#target").append(this[x] + "<br/>")
     }
});

subscribe("APILOAD", function(){
    console.log("Run 1")
    document.getElementById("target").innerHTML = "Subscribed to: APILOAD<br/>"

    var script = document.createElement("script");
    script.src = "https://code.jquery.com/jquery-2.1.4.min.js";
    script.onload = function(){
        publish("jquery ready")
    }
    document.body.appendChild(script);
});


publish("APILOAD");

subscribe("jquery ready", function(){
    $("#target").append("Wait a minute, this was subscribed AFTER the publish. Neat")
})

// Let us test removing subscriptions!

//Store id as subscribes returns a unique id
var sub_id = subscribe('test_remove', function(){
    document.getElementById("target").innerHTML += "Subscribed to: test_remove<br/>"
})

publish("test_remove");

unsubscribe(sub_id)

publish("test_remove");

</script>

</pre>
</body>